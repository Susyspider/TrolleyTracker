<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>UPRM Trolley Routes</title>
    <style>
      html, body, #map-canvas {
        height: 100%;
        margin: 0px;
        padding: 0px
      }
    </style>
    <link rel="stylesheet" href="css/jquery.mobile-1.3.1.css" />
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?libraries=geometry&sensor=false"></script>
	<!--script src="js/jquery-1.10.2.js"></script-->
	<script src="js/jquery.mobile-1.3.1.js"></script>
    <script type="text/javascript" src="appjs/app.js"></script>
    <script type="text/javascript" src="appjs/markerwithlabel.js"></script>
    <script type="text/javascript" src="appjs/global.js"></script>
    <script>

function getPathLength(polyline){
}

function animateArrows() {
    var count = 0;
    window.setInterval(function() {
      count = (count + 1) % 6400;

      var icons = line.get('icons');
      icons[0].offset = (count / 64) + '%';
      line.set('icons', icons);
      
      var icons2 = line2.get('icons');
      icons2[0].offset = (count / 64) + '%';
      line2.set('icons', icons2);
      
      var icons3 = line3.get('icons');
      icons3[0].offset = (count / 64) + '%';
      line3.set('icons', icons3);
      
      var icons4 = line4.get('icons');
      icons4[0].offset = (count / 64) + '%';
      line4.set('icons', icons4);
      
      var icons5 = line5.get('icons');
      icons5[0].offset = (count / 64) + '%';
      line5.set('icons', icons5);
      
  }, 20);
}



function RouteControl(controlDiv, map) {

  // Set CSS styles for the DIV containing the control
  // Setting padding to 5 px will offset the control
  // from the edge of the map
  controlDiv.style.padding = '5px';

  // Set CSS for the control border
  var controlUI = document.createElement('div');
  controlUI.style.backgroundColor = 'white';
  controlUI.style.borderStyle = 'solid';
  controlUI.style.borderWidth = '2px';
  controlUI.style.cursor = 'pointer';
  controlUI.style.textAlign = 'center';
  controlUI.title = 'Click to toggle Route 1 visibility';
  controlDiv.appendChild(controlUI);

  // Set CSS for the control interior
  var controlText = document.createElement('div');
  controlText.style.fontFamily = 'Arial,sans-serif';
  controlText.style.fontSize = '12px';
  controlText.style.paddingLeft = '4px';
  controlText.style.paddingRight = '4px';
  controlText.innerHTML = '<b>Palacio</b>';
  controlUI.appendChild(controlText);

  // Setup the click event listeners: simply set the map to
  // Chicago
  google.maps.event.addDomListener(controlUI, 'click', function() {
  	var Route = line;
  	
    if(Route.getVisible()){ 
      Route.setVisible(false);
      var pathlength = google.maps.geometry.spherical.computeLength(Palacio);
      var kms = Math.round(pathlength/1000 * 100) / 100;
      var miles = Math.round(pathlength/1609 * 100) / 100;
      alert('Path length is supposedly: '+miles+' miles ('+kms+' kilometers). ');
   }
   else{
      Route.setVisible(true);
      //center on route
      }
  });
}

function Route2Control(controlDiv, map) {

  // Set CSS styles for the DIV containing the control
  // Setting padding to 5 px will offset the control
  // from the edge of the map
  controlDiv.style.padding = '5px';

  // Set CSS for the control border
  var controlUI = document.createElement('div');
  controlUI.style.backgroundColor = 'white';
  controlUI.style.borderStyle = 'solid';
  controlUI.style.borderWidth = '2px';
  controlUI.style.marginTop = '4px';
  controlUI.style.cursor = 'pointer';
  controlUI.style.textAlign = 'center';
  controlUI.title = 'Click to toggle Route 2 visibility';
  controlDiv.appendChild(controlUI);

  // Set CSS for the control interior
  var controlText = document.createElement('div');
  controlText.style.fontFamily = 'Arial,sans-serif';
  controlText.style.fontSize = '12px';
  controlText.style.paddingLeft = '4px';
  controlText.style.paddingRight = '4px';
  controlText.innerHTML = '<b>Interno</b>';
  controlUI.appendChild(controlText);

  // Setup the click event listeners: simply set the map to
  // Chicago
  google.maps.event.addDomListener(controlUI, 'click', function() {
  	var Route = line2;
  	getPathLength(Interno);
    if(Route.getVisible()){ 
      Route.setVisible(false);
   }
   else{
      Route.setVisible(true);
      //center on route
      }
  });
}

function Route3Control(controlDiv, map) {

  // Set CSS styles for the DIV containing the control
  // Setting padding to 5 px will offset the control
  // from the edge of the map
  controlDiv.style.padding = '5px';

  // Set CSS for the control border
  var controlUI = document.createElement('div');
  controlUI.style.backgroundColor = 'white';
  controlUI.style.borderStyle = 'solid';
  controlUI.style.borderWidth = '2px';
  controlUI.style.marginTop = '4px';
  controlUI.style.cursor = 'pointer';
  controlUI.style.textAlign = 'center';
  controlUI.title = 'Click to toggle Route 3 visibility';
  controlDiv.appendChild(controlUI);

  // Set CSS for the control interior
  var controlText = document.createElement('div');
  controlText.style.fontFamily = 'Arial,sans-serif';
  controlText.style.fontSize = '12px';
  controlText.style.paddingLeft = '4px';
  controlText.style.paddingRight = '4px';
  controlText.innerHTML = '<b>Terrace</b>';
  controlUI.appendChild(controlText);

  // Setup the click event listeners: simply set the map to
  // Chicago
  google.maps.event.addDomListener(controlUI, 'click', function() {
  	var Route = line3;
    if(Route.getVisible()){ 
      Route.setVisible(false);
   }
   else{
      Route.setVisible(true);
      //center on route
      }
  });
}

function Route4Control(controlDiv, map) {

  // Set CSS styles for the DIV containing the control
  // Setting padding to 5 px will offset the control
  // from the edge of the map
  controlDiv.style.padding = '5px';

  // Set CSS for the control border
  var controlUI = document.createElement('div');
  controlUI.style.backgroundColor = 'white';
  controlUI.style.borderStyle = 'solid';
  controlUI.style.borderWidth = '2px';
  controlUI.style.marginTop = '4px';
  controlUI.style.cursor = 'pointer';
  controlUI.style.textAlign = 'center';
  controlUI.title = 'Click to toggle Route 4 visibility';
  controlDiv.appendChild(controlUI);

  // Set CSS for the control interior
  var controlText = document.createElement('div');
  controlText.style.fontFamily = 'Arial,sans-serif';
  controlText.style.fontSize = '12px';
  controlText.style.paddingLeft = '4px';
  controlText.style.paddingRight = '4px';
  controlText.innerHTML = '<b>Darlington</b>';
  controlUI.appendChild(controlText);

  // Setup the click event listeners: simply set the map to
  // Chicago
  google.maps.event.addDomListener(controlUI, 'click', function() {
  	var Route = line4;
    if(Route.getVisible()){ 
      Route.setVisible(false);
   }
   else{
      Route.setVisible(true);
      //center on route
      }
  });
}

function Route5Control(controlDiv, map) {

  // Set CSS styles for the DIV containing the control
  // Setting padding to 5 px will offset the control
  // from the edge of the map
  controlDiv.style.padding = '5px';

  // Set CSS for the control border
  var controlUI = document.createElement('div');
  controlUI.style.backgroundColor = 'white';
  controlUI.style.borderStyle = 'solid';
  controlUI.style.borderWidth = '2px';
  controlUI.style.marginTop = '4px';
  controlUI.style.cursor = 'pointer';
  controlUI.style.textAlign = 'center';
  controlUI.title = 'Click to toggle Route 5 visibility';
  controlDiv.appendChild(controlUI);

  // Set CSS for the control interior
  var controlText = document.createElement('div');
  controlText.style.fontFamily = 'Arial,sans-serif';
  controlText.style.fontSize = '12px';
  controlText.style.paddingLeft = '4px';
  controlText.style.paddingRight = '4px';
  controlText.innerHTML = '<b>Zoologico</b>';
  controlUI.appendChild(controlText);

  // Setup the click event listeners: simply set the map to
  // Chicago
  google.maps.event.addDomListener(controlUI, 'click', function() {
  	var Route = line5;
    if(Route.getVisible()){ 
      Route.setVisible(false);
   }
   else{
      Route.setVisible(true);
      //center on route
      }
  });
}

function initialize() {
  var mapOptions = {
    zoom: 17,
    center: new google.maps.LatLng(18.209438,-67.140543),
    mapTypeId: google.maps.MapTypeId.ROADMAP
  };

  var map = new google.maps.Map(document.getElementById('map-canvas'),
      mapOptions);
      
  // Create the DIV to hold the control and
  // call the RouteControl() constructor passing
  // in this DIV.
  var routeControlDiv = document.createElement('div');
  var routeControl = new RouteControl(routeControlDiv, map); 
  var route2Control = new Route2Control(routeControlDiv, map); 
  var route3Control = new Route3Control(routeControlDiv, map);
  var route4Control = new Route4Control(routeControlDiv, map);
  var route5Control = new Route5Control(routeControlDiv, map);

  routeControlDiv.index = 1;
  map.controls[google.maps.ControlPosition.TOP_RIGHT].push(routeControlDiv);
  
  //Routes
  var route1 = new google.maps.Polyline({
    path: Palacio,
    visible: false,
    geodesic: true,
    strokeColor: '#FF0000',
    strokeOpacity: 0.6,
    strokeWeight: 10
  });
  
  var route2 = new google.maps.Polyline({
    path: Zoologico,
    visible: false,
    geodesic: true,
    strokeColor: '#CC0066',
    strokeOpacity: 0.6,
    strokeWeight: 10
  });
  
  var route3 = new google.maps.Polyline({
    path: Interno,
    visible: false,
    geodesic: true,
    strokeColor: '#FFCC00',
    strokeOpacity: 0.6,
    strokeWeight: 10
  });
  
  var route4 = new google.maps.Polyline({
    path: Terrace,
    visible: false,
    geodesic: true,
    strokeColor: '#660066',
    strokeOpacity: 0.6,
    strokeWeight: 10
  });
  
  var route5 = new google.maps.Polyline({
    path: Darlington,
    visible: false,
    geodesic: true,
    strokeColor: '#330000',
    strokeOpacity: 0.6,
    strokeWeight: 10
  });
  
  //Stations
  //var myLatlng = new google.maps.LatLng(18.209018,-67.140351);

  marker = new google.maps.Marker({
	    position: Palacio[0],
	    title:"Palacio_start"
	});
	
  //ANIMATED SYMBOLS
  // Define the symbol, using one of the predefined paths ('CIRCLE')
  // supplied by the Google Maps JavaScript API.
  
  //Palacio
  var lineSymbol = {
    path: google.maps.SymbolPath.FORWARD_CLOSED_ARROW,
    scale: 5,
    strokeColor: '#000000',
    strokeWeight: 2,
    fillOpacity: 1,
    fillColor: '#FF0000'
  };
  
  //Interno
  var lineSymbol2 = {
    path: google.maps.SymbolPath.FORWARD_CLOSED_ARROW,
    scale: 5,
    strokeColor: '#000000',
    strokeWeight: 2,
    fillOpacity: 1,
    fillColor: '#FFFF00'
  };
  
  //Terrace
  var lineSymbol3 = {
    path: google.maps.SymbolPath.FORWARD_CLOSED_ARROW,
    scale: 5,
    strokeColor: '#000000',
    strokeWeight: 2,
    fillOpacity: 1,
    fillColor: '#FF00FF'
  };
  
  //Darlington
  var lineSymbol4 = {
    path: google.maps.SymbolPath.FORWARD_CLOSED_ARROW,
    scale: 5,
    strokeColor: '#000000',
    strokeWeight: 2,
    fillOpacity: 1,
    fillColor: '#00FF00'
  };
  
  //Zoologico
  var lineSymbol5 = {
    path: google.maps.SymbolPath.FORWARD_CLOSED_ARROW,
    scale: 5,
    strokeColor: '#000000',
    strokeWeight: 2,
    fillOpacity: 1,
    fillColor: '#00FFFF'
  };

  // Create the polyline and add the symbol to it via the 'icons' property.
  line = new google.maps.Polyline({
    path: Palacio,
    strokeColor: '#FF0000',
    strokeOpacity: 0.6,
    strokeWeight: 10,
    icons: [{
      icon: lineSymbol,
      offset: '100%'
    }],
    map: map
  });
  
  line2 = new google.maps.Polyline({
  	visible: false,
    path: Interno,
    strokeColor: '#FFFF00',
    strokeOpacity: 0.6,
    strokeWeight: 10,
    icons: [{
      icon: lineSymbol2,
      offset: '100%'
    }],
    map: map
  });
  
  line3 = new google.maps.Polyline({
  	visible: false,
    path: Terrace,
    strokeColor: '#FF00FF',
    strokeOpacity: 0.6,
    strokeWeight: 10,
    icons: [{
      icon: lineSymbol3,
      offset: '100%'
    }],
    map: map
  });
  
  line4 = new google.maps.Polyline({
  	visible: false,
    path: Darlington,
    strokeColor: '#00FF00',
    strokeOpacity: 0.6,
    strokeWeight: 10,
    icons: [{
      icon: lineSymbol4,
      offset: '100%'
    }],
    map: map
  });
  
  line5 = new google.maps.Polyline({
  	visible: false,
    path: Zoologico,
    strokeColor: '#00FFFF',
    strokeOpacity: 0.6,
    strokeWeight: 10,
    icons: [{
      icon: lineSymbol5,
      offset: '100%'
    }],
    map: map
  });
  
  animateArrows();
	
  // To add the marker to the map, call setMap();
  marker.setMap(map);
  //route1.setMap(map);
  //route2.setMap(map);
  //route3.setMap(map);
  //route4.setMap(map);
  //route5.setMap(map);
}

function chgCoords()
{
	var coords;
	var index = 0;
	setInterval(function(){
		coords = Interno_trolley[index % Interno_trolley.length];
		index++;
		marker.setPosition(coords);
		marker.setMap(map);
	},1000);
}

window.onload = chgCoords;

google.maps.event.addDomListener(window, 'load', initialize);

    </script>
  </head>
  <body>
    <div id="map-canvas"></div>
  </body>
</html>